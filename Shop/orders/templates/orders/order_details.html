{% extends 'base.html' %}

{% load i18n %}

{% load crispy_forms_filters %}

{% load static %}

{% block title %} {% translate 'Order Details' %} {% endblock %}

{% block content %}
    <div class="container col-12 card py-4 px-1">


        <table class="table table-info w-75 mx-auto">
            <thead>
            <tr>
                <th colspan="4"><h3 class="text-center">{% translate 'Checkout' %}</h3></th>
            </tr>


            <tr class="text-center">

                <th scope="col">{% translate 'Image' %}</th>
                <th scope="col">{% translate 'Name' %}</th>
                <th scope="col">{% translate 'Quntity' %}</th>
                <th scope="col">{% translate 'Unit Price' %}</th>


            </tr>
            </thead>

            <tbody>

            {% for item in order.items.all %}

                <tr class="text-center">

                    <td><img src="{{ item.product.image.url }}" alt="{{ item.product }}" width="100" height="100"
                             style="object-fit: scale-down"></td>

                    <td class="align-middle">{{ item.product }}</td>
                    <td class="align-middle">{{ item.quantity }}</td>
                    <td class="align-middle">$ {{ item.price }}</td>


                </tr>


            {% endfor %}

            <td colspan="4" class="text-center fw-bold py-4">Total: {{ order.get_total_price }}</td>

            </tbody>
        </table>



        {% if not order.is_paid %}
            <h3 class="text-center mb-4">{% translate 'Shipping Address' %}</h3>
            <div>
                <form action="" method="post" class="w-75 mx-auto">
                    {% csrf_token %}
                    {{ form|crispy }}

                    <button type="submit" class="btn btn-outline-success">Save</button>
                    <a href="{% url 'customers:address_create' %}" class="btn btn-outline-primary px-2">Add New Address</a>
                </form>

            </div>
            <a href="{% url 'orders:payment' order.id %}" class="btn btn-success col-1 my-2 mx-auto">Pay</a>
        {% else %}


            <table class="table table-info w-75 mx-auto">
                <thead>
                <tr>
                    <th colspan="4" class="text-center"><h3>{% translate 'Shipping Address' %}</h3></th>
                </tr>
                <tr class="text-center">
                    <th scope="col">{% translate 'City' %}</th>
                    <th scope="col">{% translate 'Address' %}</th>
                    <th scope="col">{% translate 'Postal Code' %}</th>
                    <th scope="col">{% translate 'Phone Number' %}</th>

                </tr>
                </thead>

                <tbody>

                <tr class="text-center">
                    <td>{{ order.city }}</td>
                    <td>{{ order.body }}</td>
                    <td>{{ order.postal_code }}</td>
                    <td>{{ order.phone_number }}</td>
                </tr>
                </tbody>
            </table>

        {% endif %}
    </div>
{% endblock %}